// ðŸ”¹ Replace only YOUR_API_KEY_HERE
const OPENAI_API_KEY = 'sk-XXXXXXXXXXXXXXXXXXXX';

async function sendMessage() {
  const input = document.getElementById('userInput').value.trim();
  if(!input) return;
  const chatbox = document.getElementById('chatbox');
  chatbox.innerHTML += `<p><b>You:</b> ${input}</p>`;
  document.getElementById('userInput').value = '';
  chatbox.scrollTop = chatbox.scrollHeight;

  const loading = document.createElement('p');
  loading.innerHTML = `<b>AI:</b> ...loading`;
  chatbox.appendChild(loading);
  chatbox.scrollTop = chatbox.scrollHeight;

  try {
    const response = await fetch('https://api.codexproxy.com/openai/v1/chat/completions', {
      method:'POST',
      headers:{
        'Content-Type':'application/json',
        'Authorization':`Bearer ${OPENAI_API_KEY}`
      },
      body: JSON.stringify({
        model: "gpt-3.5-turbo",
        messages: [{role:"user", content: input}],
        max_tokens: 200
      })
    });
    const data = await response.json();
    const aiMessage = data.choices[0].message.content;
    loading.innerHTML = `<b>AI:</b> ${aiMessage}`;
    chatbox.scrollTop = chatbox.scrollHeight;
  } catch(err) {
    loading.innerHTML = `<b>AI:</b> Sorry, something went wrong.`;
    console.error(err);
  }
}
